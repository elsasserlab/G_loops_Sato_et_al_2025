#pk_df$type <- "nd"
#pk_df$type[pk_df$RRBSme > 0.1] <- "me+"
#pk_df$type[pk_df$RRBSunme > 0.1] <- "me-"
#pk_df$type[pk_df$RRBSme > 0.1 & pk_df$RRBSunme > 0.01] <- "mixed"
table(pk_df$type)
ggscatter(df,"RRBSme","CxxC_ctrl_low",color="type",size=0.2,alpha=0.1) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2")  + stat_cor(method = "pearson", label.x = 3, label.y = 30)
ggscatter(df,"RRBSunme","CxxC_ctrl_low",size=0.2,alpha=0.1) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson", label.x = 3, label.y = 30)
ggscatter(df,"RRBSme","CxxC_ctrl_low",size=0.2,alpha=0.1) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson", label.x = 3, label.y = 30)
ggscatter(df,"RRBSme","CxxC_ctrl_low",size=0.2,alpha=0.1) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
ggscatter(df,"RRBSunme","CxxC_ctrl_low",size=0.2,alpha=0.1) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
ggscatter(df,"RRBSme","CxxC_ctrl_low",color="type",size=0.2,alpha=0.1) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2")  + stat_cor(method = "pearson")
ggscatter(df,"RRBSme","CxxC_ctrl_low",color="type",size=0.2,alpha=0.1, add = "reg.line") + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2")  + stat_cor(method = "pearson")
ggscatter(df,"RRBSme","CxxC_ctrl_low",size=0.2,alpha=0.1, add = "reg.line") + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2")  + stat_cor(method = "pearson")
ggscatter(df,"RRBSme","CxxC_ctrl_low",size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2")  + stat_cor(method = "pearson")
ggscatter(df,"RRBSunme","CxxC_ctrl_low",size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
ggscatter(df,"RRBSme","CxxC_ctrl_low",size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
ggscatter(df,"RRBSme","MBD",size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2")
ggscatter(df,"RRBSme","MBD",size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
ggscatter(df,"RRBSme","MBD",size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
ggscatter(df,"RRBSunme","MBD",size=0.2,alpha=0.1) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2")
ggscatter(df,"RRBSme","CxxC_ctrl_low",size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
ggscatter(df,"RRBSunme","CxxC_ctrl_low",size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
ggscatter(df,"RRBSme","CxxC_ctrl_low",size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2")  + stat_cor(method = "pearson")
ggscatter(df,"RRBSunme","CxxC_ctrl_low",color="type", size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
ggscatter(df,"RRBSunme","CxxC_ctrl_low",color="name", size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
ggscatter(df,"RRBSunme","CxxC_ctrl_low", size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
df$RRBSratio = df$RRBSunme/(df$RRBSme+0.01)
df$RRBSratio = df$RRBSunme/(df$RRBSme+0.01)
ggscatter(df,"RRBSratio","CxxC_ctrl_low", size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
df$RRBSratio = df$RRBSunme-df$RRBSme
ggscatter(df,"RRBSratio","CxxC_ctrl_low", size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
df$RRBSratio = df$RRBSunme
ggscatter(df,"RRBSratio","CxxC_ctrl_low", size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
df$RRBSratio = df$RRBSunme-df$RRBSme
ggscatter(df,"RRBSratio","CxxC_ctrl_low", size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
ggscatter(d[df$RRBSunme > 0.1,],"RRBSunme","CxxC_ctrl_low", size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
ggscatter(df[df$RRBSunme > 0.1,],"RRBSunme","CxxC_ctrl_low", size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
ggscatter(df[df$RRBSunme > 0.2,],"RRBSunme","CxxC_ctrl_low", size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
ggscatter(df[df$RRBSunme > 0.3,],"RRBSunme","CxxC_ctrl_low", size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
ggscatter(df,"RRBSunme","CxxC_ctrl_low", size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
df$RRBSunme2 <- df$RRBSunme^2
df$RRBSunme2 <- df$RRBSunme^2
ggscatter(df,"RRBSunme2","CxxC_ctrl_low", size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
df$RRBSunme2 <- df$RRBSunme^2
ggscatter(df,"RRBSunme2","CxxC_ctrl_low", size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
df$RRBSunme2 <- df$RRBSunme^3
ggscatter(df,"RRBSunme2","CxxC_ctrl_low", size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
df$RRBSunme2 <- sqrt(df$RRBSunme)
ggscatter(df,"RRBSunme2","CxxC_ctrl_low", size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
df$CxxC2 <- df$CxxC^2
df$CxxC2 <- df$CxxC_ctrl_low^2
ggscatter(df,"RRBSunme","CxxC2", size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
df$CxxC2 <- sqrt(df$CxxC_ctrl_low)
ggscatter(df,"RRBSunme","CxxC2", size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
ggscatter(df,"RRBSunme","CxxC_Aza_low", size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
ggscatter(df,"RRBSunme","CxxC_Aza_low", size=0.2,alpha=0.1, add = "reg.line", conf.int = T)  + stat_cor(method = "pearson")
ggscatter(df,"RRBSunme","CxxC_Aza_low", size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
ggscatter(df,"RRBSme","CxxC_ctrl_low",size=0.2,alpha=0.1, add = "reg.line", conf.int = T)  + stat_cor(method = "pearson")
ggscatter(df,"RRBSme","CxxC_ctrl_low",size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2")  + stat_cor(method = "pearson")
ggscatter(df,"RRBSunme","CxxC_Aza_low", size=0.2,alpha=0.1, add = "reg.line", conf.int = T)  + stat_cor(method = "pearson")
mylist <- list(list("A","B"),list("A","B")
)
mylist
mylist <- list(list("A","B"),list("C","D")
)
paste(mylist)
paste0(mylist)
do.call(paste0, list)
do.call(paste0, mylist)
unlist(do.call(paste0, mylist))
collapse(mylist)
do.call(c, unlist(mylist, recursive=FALSE))
do.call(c, unlist(mylist, recursive=FALSE,use.names = T))
do.call(c, unlist(mylist, recursive=FALSE,use.names = F))
do.call(c, unlist(mylist,recursive = ))
do.call(c, unlist(mylist,recursive = F))
unlist(mylist,recursive = F)
unlist(mylist)
do.call(str,unlist(mylist))
do.call(str,mylist)
do.call(c,unlist(mylist))
do.call(c, unlist(mylist))
do.call(c, unlist(mylist, recursive=T))
do.call(c, unlist(mylist, recursive=FALSE))
do.call(c, unlist(mylist, recursive=TRUE))
unlist(mylist, recursive=TRUE)
do.call(paste0, unlist(mylist, recursive=TRUE))
do.call(paste0, unlist(mylist, recursive=FALSE))
do.call(paste0, unlist(mylist))
unlist(mylist)
do.call(paste0(mylist))
do.call(paste0, mylist)
do.call(paste0, unlist(mylist))
do.call(paste0, unlist(mylist, recursive=F))
unlist(unlist(mylist, recursive=F))()
unlist(unlist(mylist, recursive=F))
unlist(mylist, recursive=F)
unlist(mylist, recursive=F)
paste0(list,"-")
paste0(mylist,"-")
paste0(unlist(mylist),"-")
paste0(unlist(mylist, recursive = F),"-")
paste0("--bigwigs", unlist(mylist, recursive = F)))
paste0("--bigwigs", unlist(mylist, recursive = F))
paste0("--bigwigs ", unlist(mylist, recursive = F))
paste0("--bigwigs", unlist(mylist, recursive = T)))
paste0("--bigwigs", unlist(mylist, recursive = T))
paste0("--bigwigs ", unlist(mylist, recursive = T))
paste0("--bigwigs ", mylist)
unlist(paste0("--bigwigs ", mylist))
paste0("--bigwigs ", mylist)
paste0("--bigwigs ", unlist(mylist, recursive = T))
do.call(paste0,"--bigwigs ", unlist(mylist, recursive = T))
do.call(paste0,"--bigwigs ", unlist(mylist, recursive = F)
)
do.call(paste0,mylist)
lists.flatten(mylist)
do.call(paste, c(mylist, collapse = " "))
do.call(paste, c(mylist, collapse = "-"))
do.call(paste, c(mylist, collapse = "--bigwig"))
do.call(paste, c(mylist, collapse = "--bigwig "))
c(mylist,collapse = "--bigwig ")
do.call(paste, c(mylist, collapse = "--bigwig "))
do.call(paste0, c(mylist, collapse = "--bigwig "))
do.call(paste , c(mylist, collapse = "--bigwig "))
do.call(paste , c(mylist, collapse = "--bigwig "))
do.call(paste , c(mylist, collapse = "--bigwig ", sep = "-"))
do.call(paste , c(mylist, collapse = "--bigwig ", sep = " "))
function callTOBIAS (mylist) {
callTOBIAS <- function(mylist) {
callTOBIAS(list("A","B"))
callTOBIS(list("A", "B"))
callTOBIAS <- function(mylist) {
return paste0("--bigwig ", do.call(paste , c(mylist, collapse = "--bigwig ", sep = " "))
callTOBIAS <- function(mylist) {
return(paste0("--bigwig ", do.call(paste , c(mylist, collapse = "--bigwig ", sep = " ")))
}
callTOBIAS <- function(mylist) {
return(paste0("--bigwig ", do.call(paste , c(mylist, collapse = "--bigwig ", sep = " "))
}
return(paste0("--bigwig ", do.call(paste , c(mylist, collapse = "--bigwig ", sep = " ")))
}
callTOBIAS <- function(mylist) {
return(paste0("--bigwig ", do.call(paste , c(mylist, collapse = "--bigwig ", sep = " ")))
}
callTOBIAS <- function(mylist) {
return(paste0("--bigwig ", do.call(paste , c(mylist, collapse = "--bigwig ", sep = " "))))
}
callTOBIS(list("A", "B"))
callTOBIAS(list("A", "B"))
callTOBIAS("A")
callTOBIAS(list("A"))
callTOBIAS(list("A","B"))
callTOBIAS(list(list("A","B"),list("C","D"))
)
callTOBIAS <- function(mylist) {
return(paste0("--bigwig ", do.call(paste , c(mylist, collapse = " --bigwig ", sep = " "))))
}
callTOBIAS(list("A", "B"))
callTOBIAS(list(list("A","B"),list("C","D"))
)
callTOBIAS(list(list("A","B"),list("C","D","E"))
)
do.call(paste , c(mylist, collapse = " --bigwig ", sep = " "))
c(paste , c(t(mylist), collapse = " --bigwig ", sep = " "))
library(rtracklayer)
library(GenomicRanges)
library(wigglescout)
library(bedscout)
library(ggpubr)
library(BSgenome.Hsapiens.UCSC.hg38)
fl <- list.files(".","Omid.+.bw")
fl <- c(fl, "MBDseq_Banu.bw","ENCFF001TMS.hg38.gt50.bed.bw","ENCFF001TMS.hg38.st50.bed.bw","4DNFIJU9H3YV.bw")
df <- as.data.frame(bw_loci(fl,"CpG.UCSC.hg38.bed",labels=c("MBD","CxxC_Aza_low","CxxC_Aza_high","CxxC_ctrl_low","CxxC_ctrl_high","MBDseq","RRBSme","RRBSunme","ATAC")))
df <- df[apply(df[,6:8], 1, max)<10000,]
df$type <- "nd"
df$type[df$CxxC_ctrl_low > 10 & df$MBD > 10] <- "mixed"
df$type[(df$CxxC_ctrl_low+1)/(df$MBD+1) > 10] <- "me-"
df$type[(df$MBD+1)/(df$CxxC_ctrl_low+1) > 10] <- "me+"
#df$type <- "nd"
#df$type[df$RRBSme > 0.1] <- "me+"
#df$type[df$RRBSunme > 0.1] <- "me-"
#df$type[df$RRBSme > 0.1 & df$RRBSunme > 0.1] <- "mixed"
#table(df$type)
df$name <- df$type
cpg_anno <- makeGRangesFromDataFrame(df)
names(cpg_anno) <- df$name
export.bed(cpg_anno,"CpG.RRBSanno.hg38.bed")
pk_MBD <- rtracklayer::import("hg38/12_Omid_Aza_MBD_HighSalt_16h_S12_L001_peaks.narrowPeak")
pk_c_CxxC <- rtracklayer::import("hg38/6_Omid_ctrl_CxxC_LowSalt_16h_S6_L001_peaks.narrowPeak")
pk_A_CxxC <- rtracklayer::import("hg38/14_Omid_Aza_CxxC_LowSalt_16h_S14_L001_peaks.narrowPeak")
pk_ATAC <- rtracklayer::import("4DNFI6JKT4W5.bb")
pk_uni <- bedscout::peaks_universe(list(list("hg38/12_Omid_Aza_MBD_HighSalt_16h_S12_L001_peaks.narrowPeak","hg38/6_Omid_ctrl_CxxC_LowSalt_16h_S6_L001_peaks.narrowPeak","hg38/14_Omid_Aza_CxxC_LowSalt_16h_S14_L001_peaks.narrowPeak")),min_consensus = 1)
cpg_me <- cpg_anno[names(cpg_anno)=="me+",]
cpg_unme <- cpg_anno[names(cpg_anno)=="me-",]
cpg_mixed <- cpg_anno[names(cpg_anno)=="mixed",]
plot_euler(list(cpg_anno, pk_uni),names = c("CpG","Peaks"))
plot_euler(list(pk_ATAC, pk_uni),names = c("ATAC","Peaks"))
plot_euler(list(cpg_anno, cpg_unme,pk_c_CxxC,pk_A_CxxC),names = c("CpG","me-","ctrl","Aza"))
df <- as.data.frame(bw_loci(fl,"CpG.UCSC.hg38.bed",labels=c("MBD","CxxC_low_1","CxxC_high_1","CxxC_low_2","CxxC_high_2","MBDseq","RRBSme","RRBSunme","ATAC")))
df <- df[apply(df[,6:8], 1, max)<10000,]
df$type <- "nd"
df$type[df$CxxC_ctrl_low > 10 & df$MBD > 10] <- "mixed"
df$type[(df$CxxC_ctrl_low+1)/(df$MBD+1) > 10] <- "me-"
df$type[(df$MBD+1)/(df$CxxC_ctrl_low+1) > 10] <- "me+"
#df$type <- "nd"
#df$type[df$RRBSme > 0.1] <- "me+"
#df$type[df$RRBSunme > 0.1] <- "me-"
#df$type[df$RRBSme > 0.1 & df$RRBSunme > 0.1] <- "mixed"
#table(df$type)
df$name <- df$type
cpg_anno <- makeGRangesFromDataFrame(df)
names(cpg_anno) <- df$name
export.bed(cpg_anno,"CpG.RRBSanno.hg38.bed")
pk_MBD <- rtracklayer::import("hg38/12_Omid_Aza_MBD_HighSalt_16h_S12_L001_peaks.narrowPeak")
pk_c_CxxC <- rtracklayer::import("hg38/6_Omid_ctrl_CxxC_LowSalt_16h_S6_L001_peaks.narrowPeak")
pk_A_CxxC <- rtracklayer::import("hg38/14_Omid_Aza_CxxC_LowSalt_16h_S14_L001_peaks.narrowPeak")
pk_ATAC <- rtracklayer::import("4DNFI6JKT4W5.bb")
pk_uni <- bedscout::peaks_universe(list(list("hg38/12_Omid_Aza_MBD_HighSalt_16h_S12_L001_peaks.narrowPeak","hg38/6_Omid_ctrl_CxxC_LowSalt_16h_S6_L001_peaks.narrowPeak","hg38/14_Omid_Aza_CxxC_LowSalt_16h_S14_L001_peaks.narrowPeak")),min_consensus = 1)
cpg_me <- cpg_anno[names(cpg_anno)=="me+",]
cpg_unme <- cpg_anno[names(cpg_anno)=="me-",]
cpg_mixed <- cpg_anno[names(cpg_anno)=="mixed",]
plot_euler(list(cpg_anno, pk_uni),names = c("CpG","Peaks"))
plot_euler(list(pk_ATAC, pk_uni),names = c("ATAC","Peaks"))
plot_euler(list(cpg_anno, cpg_unme,pk_c_CxxC,pk_A_CxxC),names = c("CpG","me-","ctrl","Aza"))
plot_euler(list(pk_MBD,pk_c_CxxC,pk_A_CxxC),names = c("MBD","ctrl","Aza"))
plot_euler(list(cpg_anno, cpg_unme, pk_MBD),names = c("CpG","me-","MBD"))
plot_euler(list(cpg_me, cpg_unme,cpg_mixed, pk_c_CxxC),names = c("me+","me-","mixed","ctrl CxxC"))
plot_euler(list(cpg_me, cpg_unme,cpg_mixed, pk_MBD),names = c("me+","me-","mixed","MBD"))
pk_df <- as.data.frame(bw_loci(fl,pk_uni,labels=c("MBD","CxxC_low_1","CxxC_high_1","CxxC_low_2","CxxC_high_2","MBDseq","RRBSme","RRBSunme","ATAC")))
pk_df <- pk_df[apply(pk_df[,6:8], 1, max)<10000,]
pk_df$type <- "nd"
pk_df$type[pk_df$CxxC_ctrl_low > 10 & pk_df$MBD > 10] <- "mixed"
pk_df$type[(pk_df$CxxC_ctrl_low+1)/(pk_df$MBD+1) > 10] <- "me-"
pk_df$type[(pk_df$MBD+1)/(pk_df$CxxC_ctrl_low+1) > 10] <- "me+"
#pk_df$type <- "nd"
#pk_df$type[pk_df$RRBSme > 0.1] <- "me+"
#pk_df$type[pk_df$RRBSunme > 0.1] <- "me-"
#pk_df$type[pk_df$RRBSme > 0.1 & pk_df$RRBSunme > 0.01] <- "mixed"
table(pk_df$type)
pk_df$name <- pk_df$type
pk_anno <- makeGRangesFromDataFrame(pk_df)
names(pk_anno) <- pk_df$name
export.bed(pk_anno,"CxxC_MBD_peaks_anno.hg38.bed")
ggscatter(df,"RRBSunme","RRBSme",color="type",size=0.2,alpha=0.2)
ggscatter(df,"RRBSunme","RRBSme",color="ATAC",size=0.2,alpha=0.2) + scale_color_gradient2(midpoint=15, low="blue", mid="red",
high="darkred")
ggscatter(df,"MBD","CxxC_low_1",color="type",size=0.2,alpha=0.2)
ggscatter(df,"MBD","CxxC_low_1",color="ATAC",size=0.2,alpha=0.2) + scale_color_gradient2(midpoint=15, low="blue", mid="red",
high="darkred")
ggscatter(df,"MBD","CxxC_low_1",color="RRBSunme",size=0.2,alpha=0.2) + scale_color_gradient(low="blue", high="darkred")
plot_euler(list(cpg_anno, cpg_unme,pk_c_CxxC,pk_A_CxxC),names = c("CpG","me-","CxxC1","CxxC2"))
plot_euler(list(pk_MBD,pk_c_CxxC,pk_A_CxxC),names = c("MBD","ctrl","Aza"))
plot_euler(list(cpg_anno, cpg_unme, pk_MBD),names = c("CpG","me-","MBD"))
plot_euler(list(cpg_me, cpg_unme,cpg_mixed, pk_c_CxxC),names = c("me+","me-","mixed","ctrl CxxC"))
plot_euler(list(cpg_me, cpg_unme,cpg_mixed, pk_MBD),names = c("me+","me-","mixed","MBD"))
plot_euler(list(pk_MBD,cpg_anno,pk_A_CxxC),names = c("MBD","CpG","CxxC1"))
plot_euler(list(cpg_anno, cpg_unme,pk_c_CxxC,pk_A_CxxC),names = c("CpG","me-","CxxC1","CxxC2"))
plot_euler(list(pk_MBD,cpg_anno,pk_A_CxxC),names = c("MBD","CpG","CxxC1"))
plot_euler(list(cpg_anno, cpg_unme, pk_MBD),names = c("CpG","me-","MBD"))
plot_euler(list(cpg_me, cpg_unme,cpg_mixed, pk_c_CxxC),names = c("me+","me-","mixed","ctrl CxxC"))
plot_euler(list(cpg_me, cpg_unme,cpg_mixed, pk_MBD),names = c("me+","me-","mixed","MBD"))
pk_df <- as.data.frame(bw_loci(fl,pk_uni,labels=c("MBD","CxxC_low_1","CxxC_high_1","CxxC_low_2","CxxC_high_2","MBDseq","RRBSme","RRBSunme","ATAC")))
pk_df <- pk_df[apply(pk_df[,6:8], 1, max)<10000,]
pk_df$type <- "nd"
pk_df$type[pk_df$CxxC_ctrl_low > 10 & pk_df$MBD > 10] <- "mixed"
pk_df$type[(pk_df$CxxC_ctrl_low+1)/(pk_df$MBD+1) > 10] <- "me-"
pk_df$type[(pk_df$MBD+1)/(pk_df$CxxC_ctrl_low+1) > 10] <- "me+"
#pk_df$type <- "nd"
#pk_df$type[pk_df$RRBSme > 0.1] <- "me+"
#pk_df$type[pk_df$RRBSunme > 0.1] <- "me-"
#pk_df$type[pk_df$RRBSme > 0.1 & pk_df$RRBSunme > 0.01] <- "mixed"
table(pk_df$type)
pk_df$name <- pk_df$type
pk_anno <- makeGRangesFromDataFrame(pk_df)
names(pk_anno) <- pk_df$name
export.bed(pk_anno,"CxxC_MBD_peaks_anno.hg38.bed")
ggscatter(df,"RRBSunme","RRBSme",color="type",size=0.2,alpha=0.2)
ggscatter(df,"RRBSme","MBD",color="type",size=0.2,alpha=0.1)+ scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2")
ggscatter(df,"RRBSunme","CxxC_Aza_low", size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
ggscatter(df,"RRBSunme","CxxC_low_1", size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
ggscatter(df,"RRBSunme","MBD",size=0.2,alpha=0.1, add = "reg.line", conf.int = T) + scale_x_continuous(trans="log2") + scale_y_continuous(trans="log2") + stat_cor(method = "pearson")
ggstripchart(df,"type","ATAC",color="type",fill="type",size=0.2,alpha=0.1, add="mean_sd") + scale_y_continuous(trans="log2")
ggstripchart(df,"type","ATAC",color="type",fill="type",size=0.2,alpha=0.1, add="mean_sd") + scale_y_continuous(trans="log2")
pk_df$type <- "nd"
pk_df$type[pk_df$CxxC_ctrl_low > 10 & pk_df$MBD > 10] <- "mixed"
pk_df$type[(pk_df$CxxC_ctrl_low+1)/(pk_df$MBD+1) > 10] <- "me-"
pk_df$type[(pk_df$MBD+1)/(pk_df$CxxC_ctrl_low+1) > 10] <- "me+"
ggstripchart(df,"type","ATAC",color="type",fill="type",size=0.2,alpha=0.1, add="mean_sd") + scale_y_continuous(trans="log2")
df$type <- "nd"
df$type[df$CxxC_low_1 > 10 & df$MBD > 10] <- "mixed"
df$type[(df$CxxC_low_1+1)/(df$MBD+1) > 10] <- "me-"
df$type[(df$MBD+1)/(df$CxxC_low_1+1) > 10] <- "me+"
ggstripchart(df,"type","ATAC",color="type",fill="type",size=0.2,alpha=0.1, add="mean_sd") + scale_y_continuous(trans="log2")
ggstripchart(df,"type","CxxC_low_1",color="type",fill="type",size=0.2,alpha=0.1, add="mean_sd") + scale_y_continuous(trans="log2")
ggstripchart(df,"type","MBD",color="type",fill="type",size=0.2,alpha=0.1, add="mean_sd") + scale_y_continuous(trans="log2")
ggarrange(p1,p2,p4,ncol = 3,common.legend = T)
p4 <- plot_bw_heatmap(fl[4],"CpG.RRBSanno.hg38.bed",order_by = ord, max_rows_allowed = 200, verbose=F, mode="center", zmax=150)
rows_mbd <- bw_heatmap(fl[1],loci="CpG.RRBSanno.hg38.bed")[[1]]
rows_cxxc <- bw_heatmap(fl[2],loci="CpG.RRBSanno.hg38.bed")[[1]]
rows_rrbs_me <- bw_heatmap(fl[7],loci="CpG.RRBSanno.hg38.bed")[[1]]
rows_rrbs_unme <- bw_heatmap(fl[8],loci="CpG.RRBSanno.hg38.bed")[[1]]
me_ratio <- rowMeans(rows_cxxc)-rowMeans(rows_mbd)
mixed <- which(rowMeans(rows_cxxc) > 50 & rowMeans(rows_mbd) > 50)
me_ratio[mixed] <- me_ratio[mixed] - 10000
ord <- order(me_ratio)
#ord <- order((rowMeans(rows_rrbs_me)+0.01)/(rowMeans(rows_rrbs_unme)+0.01))
p1 <- plot_bw_heatmap(fl[1],"CpG.RRBSanno.hg38.bed",order_by = ord, max_rows_allowed = 200, verbose=F, mode="center")
p2 <- plot_bw_heatmap(fl[2],"CpG.RRBSanno.hg38.bed",order_by = ord, max_rows_allowed = 200, verbose=F, mode="center")
p3 <- plot_bw_heatmap(fl[3],"CpG.RRBSanno.hg38.bed",order_by = ord, max_rows_allowed = 200, verbose=F)
ggarrange(p1,p2,p3,ncol = 3,common.legend = T)
p4 <- plot_bw_heatmap(fl[4],"CpG.RRBSanno.hg38.bed",order_by = ord, max_rows_allowed = 200, verbose=F, mode="center", zmax=150)
p5 <- plot_bw_heatmap(fl[5],"CpG.RRBSanno.hg38.bed",order_by = ord, max_rows_allowed = 200, verbose=F)
p6 <- plot_bw_heatmap(fl[6],"CpG.RRBSanno.hg38.bed",order_by = ord, max_rows_allowed = 200, verbose=F)
p7 <- plot_bw_heatmap(fl[7],"CpG.RRBSanno.hg38.bed",order_by = ord, max_rows_allowed = 200, verbose=F,zmax = 0.5)
p8 <- plot_bw_heatmap(fl[8],"CpG.RRBSanno.hg38.bed",order_by = ord, max_rows_allowed = 200, verbose=F,zmax = 0.5)
p9 <- plot_bw_heatmap(fl[9],"CpG.RRBSanno.hg38.bed",order_by = ord, max_rows_allowed = 200, verbose=F,mode="center")
p10 <- plot_bw_heatmap('GSM8590390_THC0720GPZN_MAX_ChIP1_hg38_PE.bw',"CpG.RRBSanno.hg38.bed",order_by = ord, max_rows_allowed = 200, verbose=F,mode="center",default_na = 0)
p11 <- plot_bw_heatmap("GSM8590477_THC0816GPZN_MAX_ChIP2_hg38_PE.bw","CpG.RRBSanno.hg38.bed",order_by = ord, max_rows_allowed = 200, verbose=F,mode="center",default_na = 0)
ggarrange(p1,p2,p4,ncol = 3,common.legend = T)
ggarrange(p1,p3,p5,ncol = 3,common.legend = T)
ggarrange(p1,p4,p9,ncol = 3,common.legend = T)
ggarrange(p1,p7,p8,ncol = 3,common.legend = T)
ggarrange(p4,p7,p8,ncol = 3,common.legend = T)
ggarrange(p6,p7,p8,ncol = 3,common.legend = T)
ggarrange(p6,p10,p11,ncol = 3,common.legend = T)
max_motifs <- c(rtracklayer::import("tobias/beds/MAX_ctrl_CxxC_LowSalt.footprint_bound.bed"),rtracklayer::import("tobias/beds/MAX_ctrl_CxxC_LowSalt.footprint_unbound.bed"))
rows_score <- bw_heatmap("tobias/beds/MAX_CxxC_ctrl_lo_score.bw",loci=max_motifs,default_na = 0, mode="center")[[1]]
ord1 <- order(rowMeans(rows_score[,20:33]))
h1 <- plot_bw_heatmap('tobias/beds/MAX_CxxC_ctrl_lo_score.bw',max_motifs,order_by = ord1, max_rows_allowed = 200, verbose=F, mode="center", default_na = 0)
h2 <- plot_bw_heatmap('GSM8590390_THC0720GPZN_MAX_ChIP1_hg38_PE.bw',max_motifs,order_by = ord1, max_rows_allowed = 200, verbose=F, mode="center", default_na = 0)
h3 <- plot_bw_heatmap('14_Omid_Aza_CxxC_LowSalt_16h_S14_L001.rpgc.bw',max_motifs,order_by = ord1, max_rows_allowed = 200, verbose=F, mode="center", default_na = 0)
h4 <- plot_bw_heatmap('12_Omid_Aza_MBD_HighSalt_16h_S12_L001.rpgc.bw',max_motifs,order_by = ord1, max_rows_allowed = 200, verbose=F, mode="center", default_na = 0)
ggarrange(h1,h2,h4, ncol = 3,common.legend = T)
df <- pk_df
rows_mbd <- bw_heatmap(fl[1],loci="CpG.RRBSanno.hg38.bed")[[1]]
rows_cxxc <- bw_heatmap(fl[2],loci="CpG.RRBSanno.hg38.bed")[[1]]
rows_rrbs_me <- bw_heatmap(fl[7],loci="CpG.RRBSanno.hg38.bed")[[1]]
rows_rrbs_unme <- bw_heatmap(fl[8],loci="CpG.RRBSanno.hg38.bed")[[1]]
me_ratio <- rowMeans(rows_cxxc)-rowMeans(rows_mbd)
mixed <- which(rowMeans(rows_cxxc) > 50 & rowMeans(rows_mbd) > 50)
me_ratio[mixed] <- me_ratio[mixed] - 10000
ord <- order(me_ratio)
#ord <- order((rowMeans(rows_rrbs_me)+0.01)/(rowMeans(rows_rrbs_unme)+0.01))
p1 <- plot_bw_heatmap(fl[1],"CpG.RRBSanno.hg38.bed",order_by = ord, max_rows_allowed = 200, verbose=F, mode="center")
p2 <- plot_bw_heatmap(fl[2],"CpG.RRBSanno.hg38.bed",order_by = ord, max_rows_allowed = 200, verbose=F, mode="center")
p3 <- plot_bw_heatmap(fl[3],"CpG.RRBSanno.hg38.bed",order_by = ord, max_rows_allowed = 200, verbose=F)
ggarrange(p1,p2,p3,ncol = 3,common.legend = T)
ggarrange(p1,p2,p3,ncol = 3,common.legend = T)
rows_mbd <- bw_heatmap(fl[1],loci="CpG.RRBSanno.hg38.bed")[[1]]
rows_cxxc <- bw_heatmap(fl[2],loci="CpG.RRBSanno.hg38.bed")[[1]]
rows_rrbs_me <- bw_heatmap(fl[7],loci="CpG.RRBSanno.hg38.bed")[[1]]
rows_rrbs_unme <- bw_heatmap(fl[8],loci="CpG.RRBSanno.hg38.bed")[[1]]
ggarrange(p1,p2,p3,ncol = 3,common.legend = T)
ggarrange(h1,h2,h3, ncol = 3,common.legend = T)
df2 <- as.data.frame(bw_loci(c("tobias/beds/MAX_CxxC_ctrl_lo_score.bw",'GSM8590390_THC0720GPZN_MAX_ChIP1_hg38_PE.bw'),labels = c('TOBIAS_score','ChIP'),loci = 'CpG.UCSC.hg38.bed',default_na = 0))
df2 <- df2[df2$TOBIAS_score>0,]
df2$lgTOB <- log2(df2$TOBIAS_score)
df2$lgChIP <- log2(df2$ChIP)
ggscatter(df2,"lgTOB","lgChIP",add="reg.line")
ggscatter(df2,"lgTOB","lgChIP",add="reg.line")  + stat_cor(method = "pearson")
ggscatter(df2,"lgTOB","lgChIP",add="reg.line")  + stat_cor(method = "spearman")
ggscatter(df2,"lgTOB","lgChIP",add="reg.line")  + stat_cor(method = "pearson")
ggscatter(df2,"lgTOB","lgChIP",add="reg.line", alpha=0.2)  + stat_cor(method = "pearson")
library(wigglescout)
library(wigglescout)
plot_bw_loci_summary_heatmap('Undetermined_S0_L001.rpgc.bw','ChromHMM17.chr9.mm39lift.bed')
```{r width=9, height=6}
library(wigglescout)
plot_bw_loci_summary_heatmap('Undetermined_S0_L001.rpgc.bw','ChromHMM17.chr9.mm39lift.bed')
plot_bw_loci_summary_heatmap('Undetermined_S0_L001.rpgc.bw','ChromHMM17.chr9.mm39lift.bed')
bw_dir <- "./"
library("wigglescout")
library("ggpubr")
library("ggplot2")
library("DESeq2")
library("dplyr")
library("ggrastr")
clean <- function (fn) {
fn <- gsub(pattern = ".+/", "", x = fn)
fn <- gsub(pattern = ".mm9.+", "", x = fn)
fn <- gsub(pattern = ".mm39.+", "", x = fn)
fn <- gsub(pattern = "_S.+", "", x = fn)
fn <- gsub(pattern = "_combined.+", "", x = fn)
fn <- gsub(pattern = "G4 CnT ", "", x = fn)
fn <- gsub(pattern = "G4_CnT_", "", x = fn)
fn <- gsub(pattern = "_batch2", "", x = fn)
fn <- gsub(pattern = "-", " ", x = fn)
fn <- gsub(pattern = "_", " ", x = fn)
fn <- gsub(pattern = " HA ", " ", x = fn)
fn <- gsub(pattern = "D1D6", "FANCJ-/-", x = fn)
fn <- gsub(pattern = "P2D2", "DHX36-/-", x = fn)
fn <- gsub(pattern = "P3D4", "FANCJ-/-DHX36-/-", x = fn)
return(fn)
}
brca2 <- list.files(bw_dir,pattern="GSM.+.bw",full.names = T)
mypal <-c("green4","#505050")
pks <- bedscout::import_named_bed_into_list('G4_CnT_combined_peaks_DJ_nonDJ.mm9.bed')
plot_profile_BRCA2 <- plot_bw_profile(bwfiles = brca2[1],loci = pks, labels=c("DJ","nonDJ"),mode="center",show_error=T,colors = mypal, verbose=F) + coord_cartesian(ylim=c(0,2.5))
bw_dir <- "~/Downloads/BRCA2/"
library("wigglescout")
library("ggpubr")
library("ggplot2")
library("DESeq2")
library("dplyr")
library("ggrastr")
clean <- function (fn) {
fn <- gsub(pattern = ".+/", "", x = fn)
fn <- gsub(pattern = ".mm9.+", "", x = fn)
fn <- gsub(pattern = ".mm39.+", "", x = fn)
fn <- gsub(pattern = "_S.+", "", x = fn)
fn <- gsub(pattern = "_combined.+", "", x = fn)
fn <- gsub(pattern = "G4 CnT ", "", x = fn)
fn <- gsub(pattern = "G4_CnT_", "", x = fn)
fn <- gsub(pattern = "_batch2", "", x = fn)
fn <- gsub(pattern = "-", " ", x = fn)
fn <- gsub(pattern = "_", " ", x = fn)
fn <- gsub(pattern = " HA ", " ", x = fn)
fn <- gsub(pattern = "D1D6", "FANCJ-/-", x = fn)
fn <- gsub(pattern = "P2D2", "DHX36-/-", x = fn)
fn <- gsub(pattern = "P3D4", "FANCJ-/-DHX36-/-", x = fn)
return(fn)
}
brca2.bws <- list.files(bw_dir,pattern="ESC_.+.bw",full.names = T)
mypal <-c("green4","#505050")
brca2.peaks <- rtracklayer::import('../peaks/ESC_BRCA2_peaks.bed')
peak_universe <- rtracklayer::import("../peaks/G4_combined_min3rep.bed")
bedscout::plot_euler(list(brca2.peaks,peak_universe),names = c("BRCA2","G4"))
peak_DJs <- bedscout::import_named_bed_into_list('../peaks/G4_CnT_combined_peaks_DJ_nonDJ.bed')
p_venn_g4_brca2 <- bedscout::plot_euler(append(append(peak_DJs,peak_universe),brca2.peaks),names = c("DJ","nonDJ","G4","BRCA2"),shape = "ellipse")
ggsave(p_venn_g4_brca2,"venn_g4_brca2.pdf")
ggsave("plots/venn_g4_brca2.pdf",p_venn_g4_brca2)
peak_DJs <- bedscout::import_named_bed_into_list('../peaks/G4_CnT_combined_peaks_DJ_nonDJ.bed')
p_venn_g4_brca2 <- bedscout::plot_euler(append(append(peak_DJs,peak_universe),brca2.peaks),names = c("DJ","nonDJ","G4","BRCA2"),shape = "ellipse")
ggsave("plots/venn_g4_brca2.pdf",p_venn_g4_brca2)
p_venn_g4_brca2
bedscout::combinations_enrichment(append(append(peak_DJs,peak_universe),brca2.peaks),2.7G,ignore.strand = T)
bedscout::combinations_enrichment(append(append(peak_DJs,peak_universe),brca2.peaks),2700000000,ignore.strand = T)
bedscout::combinations_enrichment(append(append(peak_DJs,peak_universe),brca2.peaks),2700000000)
bedscout::combinations_enrichment(peak_DJs,brca2.peaks),2700000000)
bedscout::combinations_enrichment(peak_DJs,2700000000)
bedscout::combinations_enrichment(append(peak_DJs,peak_universe),2700000000)
bedscout::combinations_enrichment(append(peak_DJs,brca2.peaks),2700000000)
bedscout::combinations_enrichment(list(peak_DJs[[1]],peak_DJs[[2]],brca2.peaks),2700000000)
bedscout::combinations_enrichment(append(peak_DJs,brca2=brca2.peaks),2700000000)
pk_set <- append(append(peak_DJs,peak_universe),brca2.peaks)
names(pk_set)
names(pk_set) <- c("DJ","nonDJ","G4","Brca2")
bedscout::combinations_enrichment(pk_set,2700000000)
bedscout::plot_combinations_score(pk_set,jaccard_index)
bedscout::plot_combinations_score(pk_set,bedscout::jaccard_index())
bedscout::plot_combinations_score(pk_set,bedscout::jaccard_index
bedscout::plot_combinations_score(pk_set,bedscout::jaccard_index)
bedscout::plot_combinations_score(pk_set,bedscout::jaccard_index)
bedscout::plot_combinations_score(pk_set,bedscout::fc_enrichment
bedscout::plot_combinations_score(pk_set,bedscout::pairwise_enrichment
bedscout::plot_combinations_score(pk_set,bedscout::pairwise_enrichment)
bedscout::plot_combinations_score(pk_set,bedscout::fc_enrichment)
bedscout::plot_combinations_score(pk_set,bedscout::jaccard_index)
bedscout::plot_combinations_score(pk_set,bedscout::fc_enrichment)
bedscout::plot_combinations_score(pk_set,bedscout::fc_enrichment(genome_size = 2700000000))
bedscout::combinations_enrichment(pk_set,2700000000)
bedscout::plot_combinations_score(pk_set,bedscout::fc_enrichment(),genome_size=2700000000)
bedscout::plot_combinations_score(pk_set,bedscout::fc_enrichment,genome_size=2700000000)
bedscout::plot_combinations_score(pk_set,bedscout::fc_enrichment{genome_size=2700000000})
bedscout::combinations_enrichment(pk_set,2700000000)
bedscout::combinations_enrichment(pk_set,27000000000)
bedscout::combinations_enrichment(pk_set,270000000)
bedscout::combinations_enrichment(pk_set,2700000000)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("pqsfinder")
library(pqsfinder)
remove.packages("pqsfinder")
remove.packages("pqsfinder")
brca2.peaks <- rtracklayer::import('../peaks/ESC_BRCA2_peaks.bed')
peak_universe <- rtracklayer::import("../peaks/G4_combined_min3rep.bed")
bedscout::plot_euler(list(brca2.peaks,peak_universe),names = c("BRCA2","G4"))
ggsave("plots/venn_g4_brca2.pdf")
brca2.peaks <- rtracklayer::import('../peaks/ESC_BRCA2_peaks.bed')
peak_universe <- rtracklayer::import("../peaks/G4_combined_min3rep.bed")
bedscout::plot_euler(list(brca2.peaks,peak_universe),names = c("BRCA2","G4"))
ggsave("plots/Venn_G4_BRCA2.pdf")
peak_DJs <- bedscout::import_named_bed_into_list('../peaks/G4_CnT_combined_peaks_DJ_nonDJ.bed')
pk_set <- append(append(peak_DJs,peak_universe),brca2.peaks)
names(pk_set) <- c("DJ","nonDJ","G4","Brca2")
bedscout::plot_euler(append(append(peak_DJs,peak_universe),brca2.peaks),names = c("DJ","nonDJ","G4","BRCA2"),shape = "ellipse")
ggsave("plots/Venn_G4_Brca2_DJ.pdf")
peak_DJs <- bedscout::import_named_bed_into_list('../peaks/G4_CnT_combined_peaks_DJ_nonDJ.bed')
pk_set <- append(append(peak_DJs,peak_universe),brca2.peaks)
names(pk_set) <- c("DJ","nonDJ","G4","Brca2")
bedscout::plot_euler(append(append(peak_DJs,peak_universe),brca2.peaks),names = c("DJ","nonDJ","G4","BRCA2"),shape = "ellipse")
ggsave("plots/Venn_G4_Brca2_DJ.pdf")
ggsave("plots/Venn_G4_BRCA2_DJ.pdf")
brca2.peaks <- rtracklayer::import('../peaks/ESC_BRCA2_peaks.bed')
peak_universe <- rtracklayer::import("../peaks/G4_combined_min3rep.bed")
bedscout::plot_euler(list(brca2.peaks,peak_universe),names = c("BRCA2","G4"))
ggsave("plots/Venn_G4_BRCA2.pdf")
peak_DJs <- bedscout::import_named_bed_into_list('../peaks/G4_CnT_combined_peaks_DJ_nonDJ.bed')
pk_set <- append(append(peak_DJs,peak_universe),brca2.peaks)
names(pk_set) <- c("DJ","nonDJ","G4","Brca2")
bedscout::plot_euler(append(append(peak_DJs,peak_universe),brca2.peaks),names = c("DJ","nonDJ","G4","BRCA2"),shape = "ellipse")
ggsave("plots/Venn_G4_BRCA2_DJ.pdf")
bedscout::combinations_enrichment(pk_set,2700000000)
bedscout::plot_combinations_score(pk_set,bedscout::jaccard_index))
bedscout::plot_combinations_score(pk_set,bedscout::jaccard_index)
reticulate::repl_python()
reticulate::repl_python()
python3
reticulate::repl_python()
bedscout::combinations_enrichment(pk_set,2700000000)
reticulate::repl_python()
